---
import { Card } from 'accessible-astro-components'
import { Icon } from 'astro-icon/components'

const response = await fetch('https://graphql.datocms.com/', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    Accept: 'application/json',
    Authorization: `Bearer ${import.meta.env.DATOCMS_API_KEY}`,
  },
  body: JSON.stringify({
    query: `query Homepage {
          home {
            title
          }
          allBlogPosts {
            id
            title
            body
            description
            eventStartDate
            image {
              url
            }
          }
        }
      `,
  }),
})

const json = await response.json()
const data = json.data
const title = data.home.title
---

<div class="container w-full">
  <section>
    <!-- <h2 class="mb-5 text-5xl">Kommande evenemang</h2>
        <p class="mb-7 ml-1">Missa inte våra evenemang.</p> -->
    <div class="container">
      <ul class="events-background flex flex-wrap">
        {
          data.allBlogPosts.map((post) => (
            <li class="mb-6 w-full px-4 sm:w-1/2 md:w-1/3 lg:w-1/3 xl:w-1/3">
              <Card
                url={'/event/' + post.title?.replaceAll(' ', '-').toLowerCase()}
                title={post.title}
                footer={'Evenmanget startar:' + post.eventStartDate}
                img={post.image.url}
              >
                {post.description}
              </Card>
            </li>
          ))
        }
      </ul>
      <div class="btn flex justify-center">
        <a class="button text-center" href="/event/"> Se alla evenemang</a>
      </div>
    </div>
  </section>
</div>

<style lang="scss">
  .container {
    padding: 0.3rem;
  }

  .events-background {
    background-color: #ffeee3;
    margin-top: 4rem;
    margin-bottom: 3rem;
    padding-top: 3rem;
    padding-bottom: 5em;
    box-shadow: 1px 8px 24px 0px rgba(0, 0, 0, 0.75);
    -webkit-box-shadow: 1px 8px 24px 0px rgba(0, 0, 0, 0.75);
    -moz-box-shadow: 1px 8px 24px 0px rgba(0, 0, 0, 0.75);
  }

  .btn {
    position: relative;
    bottom: 8rem;

    .button {
      width: 295px;
      color: #fff;
      border-radius: 13px;
      background-color: #4686ff;
      border-color: #4686ff;
      box-shadow: 0px 3px 6px #00000029;
    }

    .button:hover {
      background-color: #4658ff;
    }
  }

  @media screen and (max-width: 768px) {
    /* Dina mobilspecifika CSS-regler här */
    .events-background {
      margin-top: 4rem;
    }
  }
</style>
